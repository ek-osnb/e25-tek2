# Wireshark Exercises


## Exercise 1: DHCP (Dynamic Host Configuration Protocol)

1. Start a Wireshark capture on your WiFi interface.
2. Connect to your mobile hotspot or disconnect and reconnect to your WiFi network to generate DHCP traffic.
3. In Wireshark, apply the filter `dhcp` to isolate DHCP packets.
4. Identify the DHCP Discover, Offer, Request, and Acknowledgment packets.
5. Note down the following information from the DHCP packets:
    - Find the IP address assigned to your device.
    - Find the DHCP server's IP address.
    - Find the DNS server's IP address provided by DHCP.
6. Stop the capture and save the file as `dhcp_exercise.pcapng`


## Exercise 2: ARP (Address Resolution Protocol)

1. From the same capture in Exercise 1, apply the filter `arp` to isolate ARP packets.
2. Identify an ARP Request and the corresponding ARP Reply.
3. Note down the following information:
    - The IP address and MAC address of your device.
    - The IP address and MAC address of the router (default gateway).
4. Check your systems ARP table using the command: `arp -a`

## Exercise 3: DNS (Domain Name System)

1. Start a new Wireshark capture on your WiFi interface.
2. Run the command `nslookup ek.dk` in your terminal to generate DNS traffic.
3. Stop the capture after the command completes.
4. In Wireshark, apply the filter `dns` to isolate DNS packets.
5. Identify the DNS Query and the corresponding DNS Response for `ek.dk`.
6. Note down the following information:
    - The IP address of the DNS server that responded to your query.
    - The resolved IP address for `ek.dk`.
7. Save the capture file as `dns_exercise.pcapng`


## Exercise 4: HTTP and TCP

### Generating Traffic
1. Start a new Wireshark capture on your WiFi interface.
2. Run the command `curl 172.104.246.230` in your terminal to generate HTTP traffic.
3. Stop the capture after the command completes.
4. In Wireshark, apply the filter `ip.addr == 172.104.246.230`
5. Save the capture file as `http_tcp_exercise.pcapng`

### Three-way Handshake
1. Identify the TCP three-way handshake (`SYN`, `SYN-ACK`, `ACK`) between your device and the server.
    - What is the Initial Sequence Number (ISN) of your device?
    - What is the ISN of the server?
2. Draw a diagram illustrating the three-way handshake, including sequence and acknowledgment numbers.
3. In the SYN ACK from the server, under the `Internet Protocol Version 4` section, find the `Time To Live` field = This value indicates the maximum number of hops a packet can take before being discarded. If the value is below 64/128/255, it suggests that the packet has traversed multiple routers.
4. Identify the your devices port number and the server's port number used in this communication.
5. What is the size of the TCP window advertised by the server? And what does it signify?

### Data Transfer
1. Identify the data transfer phase of the TCP connection.
2. Find the HTTP GET request sent by your device to the server.
3. What is the Host header value in the HTTP GET request?
4. Identify the HTTP response from the server.
5. What is the HTTP status code returned by the server?
6. How many bytes of data were transferred from the server to your device in the HTTP response?
7. Draw a diagram illustrating the TCP data transfer, including sequence and acknowledgment numbers.


### TCP Connection Termination
1. Identify the TCP connection termination phase (FIN, ACK).
2. Draw a diagram illustrating the TCP connection termination, including sequence and acknowledgment numbers.


### Browser traffic
Redo all the steps, but instead of using `curl`, open a web browser and navigate to `http://172.104.246.230`


## Exercise 5: ICMP (Internet Control Message Protocol)
1. Start a new Wireshark capture on your WiFi interface.
2. Run the command `ping 8.8.8.8` in your terminal to generate ICMP traffic.
3. Stop the capture after a few ping requests complete.
4. In Wireshark, apply the filter `icmp` to isolate ICMP packets.
5. Identify the ICMP Echo Request and the corresponding ICMP Echo Reply packets.
6. Which layers of the OSI model (and TCP/IP model) are involved in the ICMP communication?
7. Note down the following information:
    - The sequence number of the ICMP Echo Request packets (this is used to match requests with replies).
    - How many hops (TTL) did the ICMP packets traverse to reach `8.8.8.8`?
8. Save the capture file as `icmp_exercise.pcapng`
